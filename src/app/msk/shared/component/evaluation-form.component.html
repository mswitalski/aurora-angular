<form [formGroup]="evaluationForm" (ngSubmit)="submitForm()">
    <fieldset [disabled]="isSubmitting">
        <div *ngIf="!isEditAction" class="form-group row">
            <div *ngIf="availableSkills.length !== 0">
                <label class="col-md-2 col-form-label">{{ 'SKILL._' | translate }} <span
                    class="text-danger">*</span></label>
                <div *ngIf="skill === undefined" class="col-md-5">
                    <button type="button" class="btn btn-link" data-toggle="modal" data-target="#evaluationsModal"
                            translate>
                        BTN.SELECT-SKILL
                    </button>
                </div>
                <div *ngIf="skill !== undefined" class="col-md-5">
                    {{skill.name}}
                    <button type="button" class="btn btn-link" data-toggle="modal" data-target="#evaluationsModal"
                            translate>
                        BTN.CHANGE-SKILL
                    </button>
                </div>
                <app-form-errors [serverErrors]="validationErrors"
                                 [controlName]="'pair'"></app-form-errors>
            </div>
            <div *ngIf="availableSkills.length === 0" translate>FORM.NO-SKILLS</div>
        </div>

        <fieldset *ngIf="isUnitLeaderAction" class="form-group row">
            <label for="evaluation-leaderEvaluation" class="col-md-2 col-form-label">{{ 'EVALUATION.LEADER-EVALUATION' |
                translate }} <span class="text-danger">*</span></label>
            <div class="col-md-5">
                <select id="evaluation-leaderEvaluation" formControlName="leaderEvaluation"
                        [(ngModel)]="evaluation.leaderEvaluation" class="form-control">
                    <option *ngFor="let level of availableSkillLevels" [ngValue]="level.value" translate>{{level.text}}
                    </option>
                </select>
            </div>
        </fieldset>
        <fieldset *ngIf="isUnitLeaderAction" class="form-group row">
            <label for="evaluation-leaderExplanation" class="col-md-2 col-form-label">{{ 'EVALUATION.LEADER-EXPLANATION'
                | translate }} <span class="text-danger">*</span></label>
            <div class="col-md-5">
                <textarea
                    id="evaluation-leaderExplanation"
                    class="form-control"
                    formControlName="leaderExplanation"
                    [(ngModel)]="evaluation.leaderExplanation"
                    placeholder="{{ 'EVALUATION.LEADER-EXPLANATION' | translate }}"
                    rows="3"
                    cols="50"></textarea>
                <app-form-errors [serverErrors]="validationErrors"
                                 [controlName]="'leaderExplanation'"
                                 [formControl]="evaluationForm.controls['leaderExplanation']"
                                 [maxLength]="validation.leaderExplanation.max"
                                 ngDefaultControl></app-form-errors>
            </div>
        </fieldset>

        <fieldset *ngIf="!isUnitLeaderAction" class="form-group row">
            <label for="evaluation-selfEvaluation" class="col-md-2 col-form-label"
            >{{ 'EVALUATION.SELF-EVALUATION' | translate }} <span class="text-danger">*</span></label>
            <select id="evaluation-selfEvaluation" formControlName="selfEvaluation"
                    [(ngModel)]="evaluation.selfEvaluation" class="form-control">
                <option *ngFor="let level of availableSkillLevels" [ngValue]="level.value" translate>{{level.text}}
                </option>
            </select>
        </fieldset>
        <fieldset *ngIf="!isUnitLeaderAction" class="form-group row">
            <label for="evaluation-selfExplanation" class="col-md-2 col-form-label">{{ 'EVALUATION.SELF-EXPLANATION' |
                translate }} <span class="text-danger">*</span></label>
            <div class="col-md-5">
                <textarea
                    id="evaluation-selfExplanation"
                    class="form-control"
                    formControlName="selfExplanation"
                    [(ngModel)]="evaluation.selfExplanation"
                    placeholder="{{ 'EVALUATION.SELF-EXPLANATION' | translate }}"
                    rows="3"
                    cols="50"></textarea>
                <app-form-errors [serverErrors]="validationErrors"
                                 [controlName]="'selfExplanation'"
                                 [formControl]="evaluationForm.controls['selfExplanation']"
                                 [maxLength]="validation.selfExplanation.max"
                                 ngDefaultControl></app-form-errors>
            </div>
        </fieldset>
        <app-form-legend></app-form-legend>

        <button (click)="goBack()" type="button" class="btn btn-dark" translate>
            BTN.BACK
        </button>
        <button [disabled]="!evaluationForm.valid || skill === undefined" type="submit" class="btn btn-success"
                translate>
            BTN.SAVE
        </button>
    </fieldset>
</form>

<div class="modal fade" id="evaluationsModal" tabindex="-1" role="dialog" aria-labelledby="evaluationsModalLabel"
     aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="evaluationsModalLabel" translate>HEADER.SELECT-SKILL</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <ul *ngFor="let skill of availableSkills">
                    <li>
                        <button (click)="selectSkill(skill)" data-dismiss="modal">{{skill.name}}</button>
                    </li>
                </ul>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
